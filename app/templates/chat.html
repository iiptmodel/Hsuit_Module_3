<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediScan</title>
    <link rel="stylesheet" href="/static/css/chat.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Dashboard Stats Panel -->
    <div class="dashboard-panel">
        <div class="dashboard-header">
            <div class="logo-section">
                    <div class="logo-icon" aria-hidden="true">
                        <!-- simple professional mark -->
                        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <rect x="3" y="4" width="18" height="16" rx="3" fill="#1f4b66" />
                            <path d="M8 10h8M12 7v10" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                <div class="logo-text">
                    <h1>MediScan AI</h1>
                    <p class="tagline">Intelligent Medical Analysis with Guardrails</p>
                </div>
                    <div style="position: absolute; top: 0.6rem; right: 1rem;">
                        <button id="themeToggleBtn" class="btn-icon" title="Toggle theme" aria-label="Toggle theme">
                            <!-- sun/moon icon -->
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
            </div>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><span class="stat-dot" aria-hidden="true"></span></div>
                    <div class="stat-content">
                        <div class="stat-value" id="total-reports">0</div>
                        <div class="stat-label">Reports</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><span class="stat-dot" aria-hidden="true"></span></div>
                    <div class="stat-content">
                        <div class="stat-value" id="total-chats">0</div>
                        <div class="stat-label">Chats</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><span class="stat-dot" aria-hidden="true"></span></div>
                    <div class="stat-content">
                        <div class="stat-value">MedGemma</div>
                        <div class="stat-label">AI Model</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><span class="stat-dot" aria-hidden="true"></span></div>
                    <div class="stat-content">
                        <div class="stat-value">Protected</div>
                        <div class="stat-label">Guardrails Active</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-container">
        <!-- Sidebar -->
        <div class="chat-sidebar">
            <div class="sidebar-header">
                <h2>Chat Sessions</h2>
                <button class="btn-new-session" id="newSessionBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    New Chat
                </button>
            </div>
            <div class="session-list" id="sessionList">
                <!-- Sessions will be loaded here -->
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="chat-main">
            <!-- Welcome Screen -->
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-content">
                    <div class="welcome-icon" aria-hidden="true">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="4" width="18" height="16" rx="3" fill="#1f4b66" />
                            <path d="M8 10h8M12 7v10" stroke="#fff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h2>Welcome to MediScan</h2>
                    <p class="muted">Upload a medical document to get a concise, safe summary or a clinician-facing report.</p>
                    
                    <div class="feature-cards">
                        <div class="feature-card">
                            <h3>Document & Image Analysis</h3>
                            <p class="muted">Upload reports or images for concise patient summaries or clinician reports.</p>
                        </div>
                        <div class="feature-card">
                            <h3>Interactive Chat</h3>
                            <p class="muted">Ask focused questions and get safe, explainable answers.</p>
                        </div>
                    </div>

                    <div class="quick-start">
                        <h3>Get Started</h3>
                        <p>Create a new chat session or upload a medical document to begin</p>
                        <button class="btn-primary" id="quickStartBtn">Start New Session</button>
                    </div>
                </div>
            </div>

            <!-- Chat Screen -->
            <div class="chat-screen" id="chatScreen" style="display: none;">
                <div class="chat-header">
                    <div class="session-info">
                        <h2 id="sessionTitle">Medical Analysis Chat</h2>
                        <span class="session-status">‚óè Active</span>
                    </div>
                    <div class="chat-actions">
                        <button class="btn-icon" id="clearChatBtn" title="Clear Chat">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <path d="M19 7L18.1327 19.1425C18.0579 20.1891 17.187 21 16.1378 21H7.86224C6.81296 21 5.94208 20.1891 5.86732 19.1425L5 7M10 11V17M14 11V17M15 7V4C15 3.44772 14.5523 3 14 3H10C9.44772 3 9 3.44772 9 4V7M4 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="messages-container" id="messagesContainer">
                    <!-- Messages will be loaded here -->
                </div>

                <!-- File Upload Area -->
                <div class="file-upload-area" id="fileUploadArea">
                    <div class="uploaded-files" id="uploadedFiles" style="display: none;">
                        <!-- Uploaded files preview will appear here -->
                    </div>
                </div>

                <!-- Input Area -->
                <div class="input-area">
                    <input type="file" id="fileInput" accept=".pdf,.png,.jpg,.jpeg,.bmp,.tiff" style="display: none;">
                    <button class="btn-attach" id="attachBtn" title="Attach File">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M21.4 7.5C21.4 6.1 20.3 5 18.9 5H5.1C3.7 5 2.6 6.1 2.6 7.5V16.5C2.6 17.9 3.7 19 5.1 19H18.9C20.3 19 21.4 17.9 21.4 16.5V7.5Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M7 9L12 13L17 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    <div class="audience-select">
                        <label for="audienceSelect" class="visually-hidden">Audience</label>
                        <select id="audienceSelect" title="Send as:" aria-label="Audience">
                            <option value="patient" selected>Patient</option>
                            <option value="doctor">Doctor</option>
                        </select>
                    </div>
                    <div class="input-wrapper">
                        <textarea 
                            id="messageInput" 
                            placeholder="Type your message or question here... (You can also attach files)"
                            rows="1"
                        ></textarea>
                    </div>
                    <button class="btn-send" id="sendBtn" disabled>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/chat.js"></script>
</body>
</html>
