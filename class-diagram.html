<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Report Analysis System - Class Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            padding: 40px 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.2em;
            font-weight: 300;
        }

        .diagram-container {
            width: 100%;
            overflow-x: auto;
            background: #fafbfc;
            border-radius: 15px;
            padding: 30px;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        svg {
            display: block;
            margin: 0 auto;
        }

        /* Class box styling */
        .class-box {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .class-box:hover .class-rect {
            filter: drop-shadow(6px 8px 16px rgba(102, 126, 234, 0.5));
            stroke-width: 3;
        }

        .class-rect {
            filter: drop-shadow(3px 5px 8px rgba(0, 0, 0, 0.15));
            transition: all 0.3s ease;
        }

        /* Model classes */
        .model-class .class-rect {
            fill: #dbeafe;
            stroke: #2563eb;
            stroke-width: 2;
        }

        /* Service classes */
        .service-class .class-rect {
            fill: #fce7f3;
            stroke: #db2777;
            stroke-width: 2;
        }

        /* API classes */
        .api-class .class-rect {
            fill: #e0f2fe;
            stroke: #0284c7;
            stroke-width: 2;
        }

        /* Core classes */
        .core-class .class-rect {
            fill: #fef3c7;
            stroke: #f59e0b;
            stroke-width: 2;
        }

        /* Utility classes */
        .utility-class .class-rect {
            fill: #d1fae5;
            stroke: #10b981;
            stroke-width: 2;
        }

        .class-name {
            font-size: 16px;
            font-weight: 700;
            fill: #1e293b;
        }

        .class-stereotype {
            font-size: 12px;
            font-style: italic;
            fill: #64748b;
        }

        .attribute-text, .method-text {
            font-size: 12px;
            fill: #334155;
            font-family: 'Courier New', monospace;
        }

        .section-line {
            stroke: #64748b;
            stroke-width: 1;
        }

        /* Relationships */
        .relationship {
            stroke: #64748b;
            stroke-width: 2;
            fill: none;
            transition: all 0.3s ease;
        }

        .relationship:hover {
            stroke: #667eea;
            stroke-width: 3;
        }

        .inheritance {
            stroke: #2563eb;
            stroke-width: 2;
        }

        .association {
            stroke: #64748b;
            stroke-width: 2;
        }

        .dependency {
            stroke: #94a3b8;
            stroke-width: 2;
            stroke-dasharray: 6, 3;
        }

        .composition {
            stroke: #1e293b;
            stroke-width: 2.5;
        }

        .aggregation {
            stroke: #475569;
            stroke-width: 2;
        }

        .label-text {
            font-size: 11px;
            fill: #475569;
            font-style: italic;
        }

        .multiplicity {
            font-size: 10px;
            fill: #64748b;
            font-weight: 600;
        }

        /* Legend */
        .legend {
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 15px;
            border: 2px solid #cbd5e1;
        }

        .legend h3 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }

        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .legend-symbol {
            margin-right: 15px;
            flex-shrink: 0;
        }

        .legend-text {
            font-size: 14px;
            color: #334155;
        }

        .legend-text strong {
            display: block;
            color: #1e293b;
            margin-bottom: 2px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .subtitle {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè• Medical Report Analysis System</h1>
        <p class="subtitle">Class Diagram</p>

        <div class="diagram-container">
            <svg width="1700" height="1400" viewBox="0 0 1700 1400" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <!-- Arrow markers for relationships -->
                    <marker id="inheritance-arrow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                        <polygon points="0 0, 12 6, 0 12" fill="white" stroke="#2563eb" stroke-width="2"/>
                    </marker>
                    <marker id="association-arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
                        <polygon points="0 0, 10 5, 0 10" fill="#64748b"/>
                    </marker>
                    <marker id="dependency-arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
                        <polygon points="0 0, 10 5, 0 10" fill="white" stroke="#94a3b8" stroke-width="1"/>
                    </marker>
                    <marker id="composition-diamond" markerWidth="12" markerHeight="12" refX="0" refY="6" orient="auto">
                        <polygon points="0 6, 6 0, 12 6, 6 12" fill="#1e293b"/>
                    </marker>
                    <marker id="aggregation-diamond" markerWidth="12" markerHeight="12" refX="0" refY="6" orient="auto">
                        <polygon points="0 6, 6 0, 12 6, 6 12" fill="white" stroke="#475569" stroke-width="2"/>
                    </marker>
                </defs>

                <!-- Database Models (Top Row) -->
                
                <!-- Report Model -->
                <g class="class-box model-class" id="report-model">
                    <rect class="class-rect" x="50" y="50" width="280" height="280" rx="8"/>
                    <text class="class-stereotype" x="190" y="75" text-anchor="middle">¬´Model¬ª</text>
                    <text class="class-name" x="190" y="95" text-anchor="middle">Report</text>
                    <line class="section-line" x1="50" y1="105" x2="330" y2="105"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="60" y="125">+ id: Integer</text>
                    <text class="attribute-text" x="60" y="143">+ created_at: DateTime</text>
                    <text class="attribute-text" x="60" y="161">+ language: String</text>
                    <text class="attribute-text" x="60" y="179">+ status: ReportStatus</text>
                    <text class="attribute-text" x="60" y="197">+ report_type: ReportType</text>
                    <text class="attribute-text" x="60" y="215">+ raw_text: Text</text>
                    <text class="attribute-text" x="60" y="233">+ original_file_path: String</text>
                    <text class="attribute-text" x="60" y="251">+ summary_text: Text</text>
                    <text class="attribute-text" x="60" y="269">+ audio_file_path: String</text>
                    
                    <line class="section-line" x1="50" y1="280" x2="330" y2="280"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="60" y="300">+ to_dict(): Dict</text>
                    <text class="method-text" x="60" y="318">+ __repr__(): String</text>
                </g>

                <!-- ChatSession Model -->
                <g class="class-box model-class" id="session-model">
                    <rect class="class-rect" x="380" y="50" width="280" height="220" rx="8"/>
                    <text class="class-stereotype" x="520" y="75" text-anchor="middle">¬´Model¬ª</text>
                    <text class="class-name" x="520" y="95" text-anchor="middle">ChatSession</text>
                    <line class="section-line" x1="380" y1="105" x2="660" y2="105"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="390" y="125">+ id: Integer</text>
                    <text class="attribute-text" x="390" y="143">+ created_at: DateTime</text>
                    <text class="attribute-text" x="390" y="161">+ title: String</text>
                    <text class="attribute-text" x="390" y="179">+ messages: List[ChatMessage]</text>
                    
                    <line class="section-line" x1="380" y1="190" x2="660" y2="190"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="390" y="210">+ add_message(msg): void</text>
                    <text class="method-text" x="390" y="228">+ get_history(): List</text>
                    <text class="method-text" x="390" y="246">+ to_dict(): Dict</text>
                </g>

                <!-- ChatMessage Model -->
                <g class="class-box model-class" id="message-model">
                    <rect class="class-rect" x="710" y="50" width="280" height="220" rx="8"/>
                    <text class="class-stereotype" x="850" y="75" text-anchor="middle">¬´Model¬ª</text>
                    <text class="class-name" x="850" y="95" text-anchor="middle">ChatMessage</text>
                    <line class="section-line" x1="710" y1="105" x2="990" y2="105"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="720" y="125">+ id: Integer</text>
                    <text class="attribute-text" x="720" y="143">+ session_id: Integer</text>
                    <text class="attribute-text" x="720" y="161">+ created_at: DateTime</text>
                    <text class="attribute-text" x="720" y="179">+ role: String</text>
                    <text class="attribute-text" x="720" y="197">+ content: Text</text>
                    <text class="attribute-text" x="720" y="215">+ audio_file_path: String</text>
                    
                    <line class="section-line" x1="710" y1="225" x2="990" y2="225"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="720" y="245">+ to_dict(): Dict</text>
                </g>

                <!-- Service Layer (Middle Row) -->
                
                <!-- ParserService -->
                <g class="class-box service-class" id="parser-service">
                    <rect class="class-rect" x="50" y="420" width="280" height="240" rx="8"/>
                    <text class="class-stereotype" x="190" y="445" text-anchor="middle">¬´Service¬ª</text>
                    <text class="class-name" x="190" y="465" text-anchor="middle">ParserService</text>
                    <line class="section-line" x1="50" y1="475" x2="330" y2="475"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="60" y="495">- converter: DocumentConverter</text>
                    
                    <line class="section-line" x1="50" y1="505" x2="330" y2="505"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="60" y="525">+ extract_data_from_file(path): str</text>
                    <text class="method-text" x="60" y="543">+ sanitize_pdf(path): str</text>
                    <text class="method-text" x="60" y="561">+ ocr_pdf(path): str</text>
                    <text class="method-text" x="60" y="579">- _parse_with_docling(path): str</text>
                    <text class="method-text" x="60" y="597">- _extract_text_from_image(): str</text>
                    <text class="method-text" x="60" y="615">- _validate_file(path): bool</text>
                    <text class="method-text" x="60" y="633">- _get_file_type(path): str</text>
                </g>

                <!-- SummarizerService -->
                <g class="class-box service-class" id="summarizer-service">
                    <rect class="class-rect" x="380" y="420" width="300" height="220" rx="8"/>
                    <text class="class-stereotype" x="530" y="445" text-anchor="middle">¬´Service¬ª</text>
                    <text class="class-name" x="530" y="465" text-anchor="middle">SummarizerService</text>
                    <line class="section-line" x1="380" y1="475" x2="680" y2="475"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="390" y="495">+ generate_summary_from_text()</text>
                    <text class="method-text" x="390" y="513">    text: str, lang: str): str</text>
                    <text class="method-text" x="390" y="535">+ generate_summary_from_image(</text>
                    <text class="method-text" x="390" y="553">    image_path: str, lang: str): str</text>
                    <text class="method-text" x="390" y="575">- _guardrail_validator(text): str</text>
                    <text class="method-text" x="390" y="593">- _call_medgemma(prompt): str</text>
                    <text class="method-text" x="390" y="611">- _build_system_prompt(lang): str</text>
                </g>

                <!-- TTSService -->
                <g class="class-box service-class" id="tts-service">
                    <rect class="class-rect" x="730" y="420" width="280" height="200" rx="8"/>
                    <text class="class-stereotype" x="870" y="445" text-anchor="middle">¬´Service¬ª</text>
                    <text class="class-name" x="870" y="465" text-anchor="middle">TTSService</text>
                    <line class="section-line" x1="730" y1="475" x2="1010" y2="475"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="740" y="495">- pipeline: KPipeline</text>
                    
                    <line class="section-line" x1="730" y1="505" x2="1010" y2="505"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="740" y="525">+ generate_speech(text, lang,</text>
                    <text class="method-text" x="740" y="543">    output_path): void</text>
                    <text class="method-text" x="740" y="561">- _validate_text(text): bool</text>
                    <text class="method-text" x="740" y="579">- _ensure_output_dir(path): void</text>
                    <text class="method-text" x="740" y="597">- _save_audio(data, path): void</text>
                </g>

                <!-- ChatService -->
                <g class="class-box service-class" id="chat-service">
                    <rect class="class-rect" x="1060" y="420" width="280" height="260" rx="8"/>
                    <text class="class-stereotype" x="1200" y="445" text-anchor="middle">¬´Service¬ª</text>
                    <text class="class-name" x="1200" y="465" text-anchor="middle">ChatService</text>
                    <line class="section-line" x1="1060" y1="475" x2="1340" y2="475"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="1070" y="495">+ process_chat_message(msg,</text>
                    <text class="method-text" x="1070" y="513">    file, session): ChatMessage</text>
                    <text class="method-text" x="1070" y="535">+ validate_user_query(query): </text>
                    <text class="method-text" x="1070" y="553">    Tuple[bool, str]</text>
                    <text class="method-text" x="1070" y="575">+ check_response_safety(resp):</text>
                    <text class="method-text" x="1070" y="593">    Tuple[bool, str]</text>
                    <text class="method-text" x="1070" y="611">- _apply_guardrails(text): str</text>
                    <text class="method-text" x="1070" y="629">- _is_prohibited(text): bool</text>
                    <text class="method-text" x="1070" y="647">- _build_context(history): List</text>
                </g>

                <!-- API Layer (Bottom Row) -->
                
                <!-- ReportsAPI -->
                <g class="class-box api-class" id="reports-api">
                    <rect class="class-rect" x="50" y="780" width="300" height="260" rx="8"/>
                    <text class="class-stereotype" x="200" y="805" text-anchor="middle">¬´FastAPI Router¬ª</text>
                    <text class="class-name" x="200" y="825" text-anchor="middle">ReportsAPI</text>
                    <line class="section-line" x1="50" y1="835" x2="350" y2="835"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="60" y="855">+ upload_text_report(text, lang):</text>
                    <text class="method-text" x="60" y="873">    Report</text>
                    <text class="method-text" x="60" y="895">+ upload_files_report(files, lang):</text>
                    <text class="method-text" x="60" y="913">    List[Report]</text>
                    <text class="method-text" x="60" y="935">+ get_reports(): List[Report]</text>
                    <text class="method-text" x="60" y="955">+ get_report(id): Report</text>
                    <text class="method-text" x="60" y="975">+ delete_report(id): void</text>
                    <text class="method-text" x="60" y="995">+ get_report_events(id): SSE</text>
                    <text class="method-text" x="60" y="1015">- _process_file(file): Report</text>
                </g>

                <!-- ChatAPI -->
                <g class="class-box api-class" id="chat-api">
                    <rect class="class-rect" x="400" y="780" width="300" height="280" rx="8"/>
                    <text class="class-stereotype" x="550" y="805" text-anchor="middle">¬´FastAPI Router¬ª</text>
                    <text class="class-name" x="550" y="825" text-anchor="middle">ChatAPI</text>
                    <line class="section-line" x1="400" y1="835" x2="700" y2="835"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="410" y="855">+ create_chat_session(data):</text>
                    <text class="method-text" x="410" y="873">    ChatSession</text>
                    <text class="method-text" x="410" y="895">+ get_chat_sessions():</text>
                    <text class="method-text" x="410" y="913">    List[ChatSession]</text>
                    <text class="method-text" x="410" y="935">+ get_chat_session(id):</text>
                    <text class="method-text" x="410" y="953">    ChatSession</text>
                    <text class="method-text" x="410" y="975">+ send_chat_message(id, msg,</text>
                    <text class="method-text" x="410" y="993">    file): ChatMessage</text>
                    <text class="method-text" x="410" y="1015">+ delete_session(id): void</text>
                    <text class="method-text" x="410" y="1035">- _generate_tts_async(msg): void</text>
                </g>

                <!-- Core/Config -->
                <g class="class-box core-class" id="settings">
                    <rect class="class-rect" x="750" y="780" width="280" height="200" rx="8"/>
                    <text class="class-stereotype" x="890" y="805" text-anchor="middle">¬´Config¬ª</text>
                    <text class="class-name" x="890" y="825" text-anchor="middle">Settings</text>
                    <line class="section-line" x1="750" y1="835" x2="1030" y2="835"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="760" y="855">+ DATABASE_URL: String</text>
                    <text class="attribute-text" x="760" y="873">+ JWT_SECRET_KEY: String</text>
                    <text class="attribute-text" x="760" y="891">+ ALGORITHM: String</text>
                    <text class="attribute-text" x="760" y="909">+ ACCESS_TOKEN_EXPIRE: int</text>
                    
                    <line class="section-line" x1="750" y1="920" x2="1030" y2="920"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="760" y="940">+ validate_config(): bool</text>
                    <text class="method-text" x="760" y="958">+ get_db_url(): String</text>
                </g>

                <!-- Database -->
                <g class="class-box core-class" id="database">
                    <rect class="class-rect" x="1080" y="780" width="280" height="180" rx="8"/>
                    <text class="class-stereotype" x="1220" y="805" text-anchor="middle">¬´Singleton¬ª</text>
                    <text class="class-name" x="1220" y="825" text-anchor="middle">Database</text>
                    <line class="section-line" x1="1080" y1="835" x2="1360" y2="835"/>
                    
                    <!-- Attributes -->
                    <text class="attribute-text" x="1090" y="855">- engine: Engine</text>
                    <text class="attribute-text" x="1090" y="873">- SessionLocal: sessionmaker</text>
                    
                    <line class="section-line" x1="1080" y1="885" x2="1360" y2="885"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="1090" y="905">+ get_db(): Generator</text>
                    <text class="method-text" x="1090" y="923">+ create_tables(): void</text>
                    <text class="method-text" x="1090" y="941">+ close_connection(): void</text>
                </g>

                <!-- Utility Classes -->
                <g class="class-box utility-class" id="text-utils">
                    <rect class="class-rect" x="1410" y="780" width="250" height="140" rx="8"/>
                    <text class="class-stereotype" x="1535" y="805" text-anchor="middle">¬´Utility¬ª</text>
                    <text class="class-name" x="1535" y="825" text-anchor="middle">TextUtils</text>
                    <line class="section-line" x1="1410" y1="835" x2="1660" y2="835"/>
                    
                    <!-- Methods -->
                    <text class="method-text" x="1420" y="855">+ sanitize_text(text): str</text>
                    <text class="method-text" x="1420" y="873">+ truncate_text(text, len): str</text>
                    <text class="method-text" x="1420" y="891">+ clean_html(text): str</text>
                    <text class="method-text" x="1420" y="909">+ extract_keywords(text): List</text>
                </g>

                <!-- Enums -->
                <g class="class-box utility-class" id="enums">
                    <rect class="class-rect" x="1080" y="1050" width="280" height="160" rx="8"/>
                    <text class="class-stereotype" x="1220" y="1075" text-anchor="middle">¬´Enum¬ª</text>
                    <text class="class-name" x="1220" y="1095" text-anchor="middle">ReportStatus / ReportType</text>
                    <line class="section-line" x1="1080" y1="1105" x2="1360" y2="1105"/>
                    
                    <!-- Values -->
                    <text class="attribute-text" x="1090" y="1125">ReportStatus:</text>
                    <text class="attribute-text" x="1100" y="1143">  PROCESSING, COMPLETED,</text>
                    <text class="attribute-text" x="1100" y="1161">  FAILED</text>
                    <text class="attribute-text" x="1090" y="1183">ReportType:</text>
                    <text class="attribute-text" x="1100" y="1201">  TEXT, IMAGE</text>
                </g>

                <!-- Relationships -->
                
                <!-- Composition: ChatSession -> ChatMessage -->
                <line class="relationship composition" x1="660" y1="160" x2="710" y2="160" marker-start="url(#composition-diamond)"/>
                <text class="multiplicity" x="670" y="150">1</text>
                <text class="multiplicity" x="695" y="150">*</text>
                <text class="label-text" x="675" y="178">contains</text>

                <!-- Dependency: ReportsAPI -> ParserService -->
                <line class="relationship dependency" x1="200" y1="780" x2="190" y2="660" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="210" y="720">¬´uses¬ª</text>

                <!-- Dependency: ReportsAPI -> SummarizerService -->
                <line class="relationship dependency" x1="280" y1="780" x2="450" y2="640" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="350" y="710">¬´uses¬ª</text>

                <!-- Dependency: ReportsAPI -> TTSService -->
                <line class="relationship dependency" x1="350" y1="860" x2="730" y2="560" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="520" y="700">¬´uses¬ª</text>

                <!-- Dependency: ChatAPI -> ChatService -->
                <line class="relationship dependency" x1="650" y1="780" x2="1120" y2="680" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="870" y="730">¬´uses¬ª</text>

                <!-- Dependency: ChatService -> SummarizerService -->
                <line class="relationship dependency" x1="1060" y1="550" x2="680" y2="530" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="850" y="520">¬´uses¬ª</text>

                <!-- Association: ReportsAPI -> Report -->
                <line class="relationship association" x1="190" y1="780" x2="190" y2="330" marker-end="url(#association-arrow)"/>
                <text class="label-text" x="200" y="550">manages</text>
                <text class="multiplicity" x="200" y="350">*</text>

                <!-- Association: ChatAPI -> ChatSession -->
                <line class="relationship association" x1="520" y1="780" x2="520" y2="270" marker-end="url(#association-arrow)"/>
                <text class="label-text" x="530" y="520">manages</text>
                <text class="multiplicity" x="530" y="290">*</text>

                <!-- Dependency: Database -> Models -->
                <line class="relationship dependency" x1="1220" y1="780" x2="520" y2="330" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="850" y="540">¬´persists¬ª</text>

                <!-- Dependency: Settings -> Database -->
                <line class="relationship dependency" x1="1030" y1="880" x2="1080" y2="880" marker-end="url(#dependency-arrow)"/>
                <text class="label-text" x="1035" y="870">¬´configures¬ª</text>

                <!-- Dependency: ParserService -> TextUtils -->
                <line class="relationship dependency" x1="330" y1="530" x2="1410" y2="850" marker-end="url(#dependency-arrow)" stroke-dasharray="6,3"/>
                <text class="label-text" x="850" y="680">¬´uses¬ª</text>

                <!-- Dependency: Report -> Enums -->
                <line class="relationship dependency" x1="330" y1="240" x2="1080" y2="1120" marker-end="url(#dependency-arrow)" stroke-dasharray="6,3"/>
                <text class="label-text" x="680" y="680">¬´type¬ª</text>

                <!-- System boundary box -->
                <rect x="20" y="20" width="1660" height="1200" rx="15" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="10,5" opacity="0.3"/>
                <text x="850" y="1250" font-size="14" fill="#64748b" text-anchor="middle" font-style="italic">Medical Report Analysis System - Object Model</text>
            </svg>
        </div>

        <!-- Legend -->
        <div class="legend">
            <h3>üìñ Class Diagram Legend</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <rect x="5" y="10" width="50" height="35" rx="4" fill="#dbeafe" stroke="#2563eb" stroke-width="2"/>
                            <line x1="5" y1="25" x2="55" y2="25" stroke="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Model Class</strong>
                        Database models (SQLAlchemy)
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <rect x="5" y="10" width="50" height="35" rx="4" fill="#fce7f3" stroke="#db2777" stroke-width="2"/>
                            <line x1="5" y1="25" x2="55" y2="25" stroke="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Service Class</strong>
                        Business logic services
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <rect x="5" y="10" width="50" height="35" rx="4" fill="#e0f2fe" stroke="#0284c7" stroke-width="2"/>
                            <line x1="5" y1="25" x2="55" y2="25" stroke="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>API Class</strong>
                        FastAPI route handlers
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <rect x="5" y="10" width="50" height="35" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
                            <line x1="5" y1="25" x2="55" y2="25" stroke="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Core Class</strong>
                        Configuration & database
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <rect x="5" y="10" width="50" height="35" rx="4" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
                            <line x1="5" y1="25" x2="55" y2="25" stroke="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Utility Class</strong>
                        Helper functions & enums
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <line x1="5" y1="25" x2="45" y2="25" stroke="#64748b" stroke-width="2"/>
                            <polygon points="45 20, 55 25, 45 30" fill="#64748b"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Association</strong>
                        References another class
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <line x1="5" y1="25" x2="45" y2="25" stroke="#94a3b8" stroke-width="2" stroke-dasharray="6,3"/>
                            <polygon points="45 20, 55 25, 45 30" fill="white" stroke="#94a3b8"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Dependency</strong>
                        Uses/depends on class
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <polygon points="5 25, 11 19, 17 25, 11 31" fill="#1e293b"/>
                            <line x1="17" y1="25" x2="55" y2="25" stroke="#1e293b" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Composition</strong>
                        Strong ownership (cascade delete)
                    </div>
                </div>

                <div class="legend-item">
                    <div class="legend-symbol">
                        <svg width="60" height="50">
                            <polygon points="5 25, 11 19, 17 25, 11 31" fill="white" stroke="#2563eb" stroke-width="2"/>
                            <line x1="17" y1="25" x2="55" y2="25" stroke="#2563eb" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="legend-text">
                        <strong>Inheritance</strong>
                        Extends/inherits from class
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>